<!-- Header -->
<div class="patients-header">
  <div class="header-content">
    <h1 class="page-title">Detalhes do Paciente</h1>
    <div class="header-actions">
      <%= link_to edit_patient_path(@patient), class: "btn-primary" do %>
        <svg viewBox="0 0 24 24" fill="currentColor" style="width: 16px; height: 16px; margin-right: 8px;">
          <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
        </svg>
        Editar Paciente
      <% end %>
      
      <%= link_to patients_path, class: "btn-secondary" do %>
        <svg viewBox="0 0 24 24" fill="currentColor" style="width: 16px; height: 16px; margin-right: 8px;">
          <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
        </svg>
        Voltar
      <% end %>
    </div>
  </div>
</div>

<!-- Patient Details -->
<div class="patient-details-container">
  <div class="patient-card">
    <div class="patient-header">
      <div class="patient-avatar">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
        </svg>
      </div>
      <div class="patient-info">
        <h2 class="patient-name"><%= @patient.name %></h2>
        <div class="patient-status">
          <span class="status-badge <%= @patient.status %>">
            <%= @patient.status == 'active' ? 'Ativo' : 'Encerrado' %>
          </span>
        </div>
      </div>
    </div>

    <div class="patient-details">
      <div class="detail-section">
        <h3 class="section-title">Informações de Contato</h3>
        <div class="detail-grid">
          <% if @patient.email.present? %>
            <div class="detail-item">
              <label class="detail-label">Email:</label>
              <span class="detail-value"><%= @patient.email %></span>
            </div>
          <% end %>
          
          <% if @patient.phone.present? %>
            <div class="detail-item">
              <label class="detail-label">Telefone:</label>
              <span class="detail-value"><%= @patient.phone %></span>
            </div>
          <% end %>
          
          <% if @patient.birth_date.present? %>
            <div class="detail-item">
              <label class="detail-label">Data de Nascimento:</label>
              <span class="detail-value"><%= @patient.birth_date.strftime("%d/%m/%Y") %></span>
            </div>
          <% end %>
        </div>
      </div>

      <% if @patient.notes.present? %>
        <div class="detail-section">
          <h3 class="section-title">Anotações</h3>
          <div class="notes-content">
            <%= simple_format(@patient.notes) %>
          </div>
        </div>
      <% end %>

      <div class="detail-section">
        <h3 class="section-title">Sessões</h3>
        <div class="sessions-summary">
          <% sessions = @patient.sessions.order(session_date: :desc).limit(5) %>
          <% if sessions.any? %>
            <div class="sessions-list">
              <% sessions.each do |session| %>
                <div class="session-item">
                  <div class="session-date">
                    <%= session.session_date.strftime("%d/%m/%Y") %>
                  </div>
                  <div class="session-time">
                    <%= session.start_time.strftime("%H:%M") %> - <%= session.end_time.strftime("%H:%M") %>
                  </div>
                  <div class="session-type">
                    <%= session.session_type.capitalize %>
                  </div>
                  <div class="session-status">
                    <% if session.confirmed? %>
                      <span class="status-confirmed">✓ Confirmada</span>
                    <% else %>
                      <span class="status-pending">⏳ Pendente</span>
                    <% end %>
                  </div>
                </div>
              <% end %>
            </div>
            <%= link_to "Ver todas as sessões", agenda_path, class: "btn-secondary" %>
          <% else %>
            <div class="empty-sessions">
              <svg viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
              </svg>
              <p>Nenhuma sessão agendada</p>
              <%= link_to "Agendar primeira sessão", new_appointment_path, class: "btn-primary" %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
